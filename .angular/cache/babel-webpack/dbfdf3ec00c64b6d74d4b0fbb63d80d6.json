{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport axios from 'axios';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/cookie.service\";\nimport * as i2 from \"../../components/loader/loader.component\";\nimport * as i3 from \"../../components/top-navigation/top-navigation.component\";\nimport * as i4 from \"ag-grid-angular\";\nexport let UserProfileComponent = /*#__PURE__*/(() => {\n  class UserProfileComponent {\n    constructor(cookieService) {\n      this.cookieService = cookieService;\n      this.showModal = true;\n      this.Shipments = [];\n      this.columnDefs = [{\n        headerName: 'Vessel',\n        field: 'vessel',\n        resizable: true,\n        sortable: true,\n        filter: true\n      }, {\n        headerName: 'Port of Load',\n        field: 'Port_Of_Load',\n        resizable: true,\n        sortable: true,\n        filter: true\n      }, {\n        headerName: 'Container #',\n        field: 'Container_No',\n        resizable: true,\n        sortable: true,\n        filter: true\n      }, {\n        headerName: 'Departure',\n        field: 'Departure',\n        resizable: true,\n        sortable: true,\n        filter: true\n      }, {\n        headerName: 'Arrival',\n        field: 'Arrival',\n        resizable: true,\n        sortable: true,\n        filter: true\n      }, {\n        headerName: 'Status',\n        field: 'Status',\n        resizable: true,\n        sortable: true,\n        filter: true\n      }, {\n        headerName: 'Documents',\n        suppressSizeToFit: true,\n        resizable: true,\n        cellRenderer: data => {\n          if (data.data.hasOwnProperty('Documents') && data.data.Documents.length > 0) {\n            let returnHtml = '<select style=\"max-width: 160px;\" class=\"btn btn-sm\" onChange=\"browseToDocument(this)\"><option value=\"0\">View document(s)</option>';\n            data.data.Documents.forEach(element => {\n              returnHtml += `<option value=\"` + environment.strapiUrl + element.url + `\">` + element.name + `</option>`;\n            });\n            returnHtml += `</select>`;\n            return returnHtml;\n          } else {\n            return 'No documents found';\n          }\n        },\n        suppressSorting: true\n      }];\n      this.jwtBearer = null;\n    }\n\n    ngOnInit() {\n      var _a, _b;\n\n      return __awaiter(this, void 0, void 0, function* () {\n        try {\n          this.user = yield this.cookieService.verifyUser();\n          this.jwtBearer = this.cookieService.readCookie('__jwtBearer');\n          const customer = yield axios.get(environment.strapiUrl + '/customers?user.username=' + ((_a = this.user) === null || _a === void 0 ? void 0 : _a.username), {\n            headers: {\n              Authorization: `Bearer ${this.jwtBearer}`\n            }\n          });\n          const documents = yield axios.get(environment.strapiUrl + '/documents?customer.user=' + ((_b = this.user) === null || _b === void 0 ? void 0 : _b.id), {\n            headers: {\n              Authorization: `Bearer ${this.jwtBearer}`\n            }\n          });\n          let userDocuments = [];\n\n          if (documents.data.length > 0) {\n            userDocuments = documents.data.filter(x => {\n              var _a;\n\n              return x.customer.user === ((_a = this.user) === null || _a === void 0 ? void 0 : _a.id);\n            });\n          }\n\n          if (customer.data[0].shipments != null) {\n            customer.data[0].shipments.forEach(element => {\n              var _a, _b;\n\n              let shipmentDocuments = new Array();\n\n              if (documents.data.length > 0) {\n                shipmentDocuments = (_a = userDocuments.find(x => x.shipment.id === element.id)) === null || _a === void 0 ? void 0 : _a.documents;\n              }\n\n              const currentShipment = {\n                Arrival: element.Arrival,\n                vessel: element.vessel,\n                Container_No: element.Container_No,\n                Departure: element.Departure,\n                Port_Of_Load: element.Port_Of_Load,\n                Status: element.Status,\n                Documents: shipmentDocuments\n              };\n              (_b = this.Shipments) === null || _b === void 0 ? void 0 : _b.push(currentShipment);\n            });\n          }\n\n          this.rowData = this.Shipments;\n        } catch (e) {\n          console.error(e);\n        }\n      });\n    }\n\n    onFirstDataRendered(params) {\n      params.api.sizeColumnsToFit();\n    }\n\n    onGridReady(params) {\n      this.gridApi = params.api;\n      this.gridColumnApi = params.columnApi;\n      setTimeout(() => {\n        params.api.sizeColumnsToFit();\n      }, 500);\n    }\n\n  }\n\n  UserProfileComponent.ɵfac = function UserProfileComponent_Factory(t) {\n    return new (t || UserProfileComponent)(i0.ɵɵdirectiveInject(i1.CookieService));\n  };\n\n  UserProfileComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UserProfileComponent,\n    selectors: [[\"app-user-profile\"]],\n    decls: 6,\n    vars: 2,\n    consts: [[1, \"container-fluid\", \"hero\"], [1, \"container\", 2, \"display\", \"flex\", \"height\", \"80vh\", \"width\", \"100%\", \"flex-direction\", \"column\"], [\"id\", \"myGrid\", 1, \"ag-theme-alpine\", 2, \"width\", \"100%\", \"height\", \"100%\", 3, \"rowData\", \"columnDefs\", \"firstDataRendered\", \"gridReady\"], [\"agGrid\", \"\"]],\n    template: function UserProfileComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-loader\");\n        i0.ɵɵelement(1, \"app-top-navigation\");\n        i0.ɵɵelementStart(2, \"div\", 0);\n        i0.ɵɵelementStart(3, \"div\", 1);\n        i0.ɵɵelementStart(4, \"ag-grid-angular\", 2, 3);\n        i0.ɵɵlistener(\"firstDataRendered\", function UserProfileComponent_Template_ag_grid_angular_firstDataRendered_4_listener($event) {\n          return ctx.onFirstDataRendered($event);\n        })(\"gridReady\", function UserProfileComponent_Template_ag_grid_angular_gridReady_4_listener($event) {\n          return ctx.onGridReady($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"rowData\", ctx.rowData)(\"columnDefs\", ctx.columnDefs);\n      }\n    },\n    directives: [i2.LoaderComponent, i3.TopNavigationComponent, i4.AgGridAngular],\n    styles: [\"body[_ngcontent-%COMP%]{background:#222222!important;color:#fff!important}.ag-cell[_ngcontent-%COMP%]{overflow:visible}.ag-row[_ngcontent-%COMP%]{z-index:0}.ag-row.ag-row-focus[_ngcontent-%COMP%]{z-index:1}.ag-root.ag-layout-auto-height[_ngcontent-%COMP%], .ag-body-viewport.ag-layout-auto-height[_ngcontent-%COMP%], .ag-body-viewport-wrapper.ag-layout-auto-height[_ngcontent-%COMP%]{overflow:visible}\"]\n  });\n  return UserProfileComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}